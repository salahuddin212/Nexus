{% load static %}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{user_object.username}} | Nexus Developer</title>
    
    <link rel="stylesheet" href="{% static 'assets/css/tailwind.css' %}">
    <link rel="stylesheet" href="{% static 'css/main.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    
    <script src="https://unpkg.com/feather-icons"></script>

    <style>
        body {
            background-color: #f3f4f6; /* Light gray background */
        }
        .project-card-img {
            height: 180px;
            width: 100%;
            object-fit: cover;
        }
        .skill-badge {
            font-size: 0.75rem;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-weight: 600;
        }
    </style>
</head>

<body>

    <nav class="bg-white border-b border-gray-200 sticky top-0 z-50">
        <div class="max-w-6xl mx-auto px-4">
            <div class="flex justify-between">
                <div class="flex space-x-7">
                    <div>
                        <a href="/" class="flex items-center py-4 px-2">
                            <span class="font-bold text-gray-700 text-2xl">Nexus</span>
                        </a>
                    </div>
                </div>
                <div class="hidden md:flex items-center space-x-3 ">
                    <a href="/" class="py-2 px-2 font-medium text-gray-500 rounded hover:bg-gray-100 transition duration-300">Project Feed</a>
                    <a href="/settings" class="py-2 px-2 font-medium text-gray-500 rounded hover:bg-gray-100 transition duration-300">Settings</a>
                </div>
            </div>
        </div>
    </nav>

    <div class="max-w-6xl mx-auto px-4 py-8">
        
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden mb-8">
            <div class="md:flex">
                <div class="md:w-1/3 bg-gray-50 p-8 flex flex-col items-center justify-center border-r border-gray-100">
                    {% if user_profile.profileimg %}
                    <img class="h-40 w-40 rounded-full object-cover border-4 border-white shadow-md mb-4" src="{{user_profile.profileimg.url}}" alt="">
                    {% else %}
                    <img class="h-40 w-40 rounded-full object-cover border-4 border-white shadow-md mb-4" src="/media/blank-profile-picture.png" alt="">
                    {% endif %}
                    <h2 class="text-2xl font-bold text-gray-800">{{user_object.username}}</h2>
                    <p class="text-gray-500 text-sm mb-4">{{user_profile.location|default:"Global"}}</p>
                    
                    <div class="flex space-x-3">
                        {% if user_object.username == user.username %}
                            <a href="/settings" class="bg-gray-200 text-gray-700 px-6 py-2 rounded-md font-medium hover:bg-gray-300 transition">
                                Edit Profile
                            </a>
                        {% else %}
                            <form action="/connect" method="POST" class="w-full flex justify-center">
                                {% csrf_token %}
                                <input type="hidden" name="user" value="{{user_object.username}}">
                                
                                {% if is_connected %}
                                    <button type="submit" class="w-full max-w-[200px] bg-red-50 border border-red-100 text-red-600 px-4 py-2 rounded-lg font-medium hover:bg-red-100 transition">
                                        Disconnect
                                    </button>
                                {% else %}
                                    <button type="submit" class="w-full max-w-[200px] bg-blue-600 border border-transparent text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-700 transition shadow-md shadow-blue-500/20">
                                        Connect
                                    </button>
                                {% endif %}
                            </form>
                        {% endif %}
                    </div>
                </div>

                <div class="md:w-2/3 p-8">
                    <div class="flex justify-around mb-8 border-b border-gray-100 pb-6">
                        <div class="text-center">
                            <span class="block text-xl font-bold text-gray-800">{{projects_count}}</span>
                            <span class="text-sm text-gray-500">Projects</span>
                        </div>
                        <div class="text-center">
                            <span class="block text-xl font-bold text-gray-800">{{network_count}}</span>
                            <span class="text-sm text-gray-500">Network</span>
                        </div>
                        <div class="text-center">
                            <span class="block text-xl font-bold text-gray-800">{{connections_count}}</span>
                            <span class="text-sm text-gray-500">Connections</span>
                        </div>
                    </div>

                    <div class="mb-6">
                        <h3 class="text-sm uppercase tracking-wide text-gray-400 font-semibold mb-2">About</h3>
                        <p class="text-gray-700 leading-relaxed">
                            {{user_profile.bio|default:"This developer hasn't written a bio yet."}}
                        </p>
                    </div>

                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center mt-6">
                        <div class="mb-4 md:mb-0">
                            <h3 class="text-sm uppercase tracking-wide text-gray-400 font-semibold mb-2">Tech Stack</h3>
                            <div class="flex flex-wrap gap-2">
                                {% if skills_list %}
                                    {% for skill in skills_list %}
                                        <span class="skill-badge bg-blue-50 text-blue-600 border border-blue-100">
                                            {{ skill }}
                                        </span>
                                    {% endfor %}
                                {% else %}
                                    <span class="text-sm text-gray-400 italic">No skills listed</span>
                                {% endif %}
                            </div>
                        </div>

                        {% if github_url %}
                        <div>
                            <a href="{{github_url}}" target="_blank" class="flex items-center space-x-2 text-gray-700 hover:text-black transition">
                                <i data-feather="github"></i>
                                <span class="font-medium">View GitHub</span>
                            </a>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>

        <h3 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
            <i data-feather="code" class="mr-2"></i> Project Portfolio
        </h3>

        {% if projects_count == 0 %}
            <div class="text-center py-20 bg-white rounded-lg border border-dashed border-gray-300">
                <div class="mx-auto h-12 w-12 text-gray-400 mb-4">
                    <i data-feather="folder" style="width: 100%; height: 100%;"></i>
                </div>
                <h3 class="mt-2 text-sm font-medium text-gray-900">No projects yet</h3>
                <p class="mt-1 text-sm text-gray-500">Get started by pitching a new project.</p>
                {% if user_object.username == user.username %}
                <div class="mt-6">
                    {% comment %} <a href="/" class="inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700">
                        <i data-feather="plus" class="mr-2 h-4 w-4"></i>
                        New Project
                    </a> {% endcomment %}
                </div>
                {% endif %}
            </div>
        {% else %}
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                {% for project in user_projects %}
                <div class="bg-white rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition duration-200 flex flex-col h-full">
                    
                    <div class="relative">
                        {% if project.image %}
                            <img src="{{project.image.url}}" class="project-card-img w-full" alt="{{project.title}}">
                        {% else %}
                            <div class="project-card-img bg-gray-100 flex items-center justify-center">
                                <span class="text-gray-400">No Preview</span>
                            </div>
                        {% endif %}
                        <div class="absolute top-2 right-2 bg-white px-2 py-1 rounded text-xs font-bold shadow text-yellow-500 flex items-center">
                            <i data-feather="star" class="w-3 h-3 mr-1 fill-current"></i> {{project.no_of_stars}}
                        </div>
                    </div>

                    <div class="p-5 flex-1 flex flex-col">
                        <h4 class="text-lg font-bold text-gray-900 mb-2 truncate">{{project.title|default:"Untitled Project"}}</h4>
                        
                        <p class="text-gray-600 text-sm mb-4 line-clamp-3 flex-1">
                            {{project.description}}
                        </p>

                        {% if project.tags %}
                        <div class="mb-4 flex flex-wrap gap-1">
                            <span class="text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded">
                                {{ project.tags }}
                            </span>
                        </div>
                        {% endif %}

                        <div class="flex justify-between items-center pt-4 border-t border-gray-100 mt-auto">
                            <span class="text-xs text-gray-400">{{ project.created_at|date:"M d, Y" }}</span>
                            
                            {% if project.github_link %}
                            <a href="{{project.github_link}}" target="_blank" class="text-blue-600 hover:text-blue-800 text-sm font-medium flex items-center">
                                Source Code <i data-feather="arrow-right" class="w-4 h-4 ml-1"></i>
                            </a>
                            {% endif %}
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        {% endif %}

    </div>

    <script>
        feather.replace()
    </script>
    <script src="{% static 'js/main.min.js' %}"></script>
    <script src="{% static 'js/script.js' %}"></script>

</body>
</html>